<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idea Management Test</title>
    <link rel="stylesheet" href="static/css/main.css">
</head>
<body>
    <div class="container">
        <h1>Idea Management Components Test</h1>
        
        <div style="margin: 20px 0;">
            <button id="test-create-btn" class="btn btn-primary create-idea-btn">Test Create Idea Modal</button>
            <button id="test-edit-btn" class="btn btn-secondary">Test Edit Idea Modal</button>
            <button id="test-delete-btn" class="btn btn-danger">Test Delete Confirmation</button>
        </div>

        <div class="ideas-container">
            <div class="ideas-header">
                <h2>Sample Ideas</h2>
                <span class="ideas-count">3 ideas</span>
            </div>
            <div id="test-ideas-list" class="ideas-list">
                <!-- Sample ideas will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Mock API for testing -->
    <script>
        // Mock API for testing
        window.api = {
            get: async (url) => {
                console.log('Mock GET:', url);
                if (url.includes('/ideas/')) {
                    return {
                        data: {
                            id: 'test-idea-1',
                            oneLiner: 'Test Idea for Editing',
                            description: 'This is a test idea description that can be edited.',
                            valueStatement: 'This provides test value for the editing functionality.',
                            riceScore: {
                                reach: 75,
                                impact: 80,
                                confidence: 4,
                                effort: 60
                            },
                            column: 'now',
                            status: 'active',
                            inProgress: true,
                            thumbsUp: 5,
                            emojiReactions: [
                                { emoji: '🚀', count: 3 },
                                { emoji: '💡', count: 2 }
                            ],
                            createdAt: new Date().toISOString()
                        }
                    };
                }
                return { data: { success: true } };
            },
            post: async (url, data) => {
                console.log('Mock POST:', url, data);
                return { data: { success: true, id: 'new-idea-' + Date.now() } };
            },
            put: async (url, data) => {
                console.log('Mock PUT:', url, data);
                return { data: { success: true } };
            },
            delete: async (url) => {
                console.log('Mock DELETE:', url);
                return { data: { success: true } };
            }
        };

        // Mock board view for testing
        window.boardView = {
            loadIdeas: async () => {
                console.log('Mock loadIdeas called');
                // Simulate refresh
                setTimeout(() => {
                    window.ideaManager.showSuccessMessage('Ideas refreshed!');
                }, 500);
            }
        };
    </script>

    <script src="static/js/idea-management.js"></script>

    <script>
        // Test setup
        document.addEventListener('DOMContentLoaded', () => {
            // Set test board ID
            window.ideaManager.setBoardId('test-board-123');

            // Create sample ideas
            const sampleIdeas = [
                {
                    id: 'idea-1',
                    oneLiner: 'Implement user authentication system',
                    description: 'Create a secure authentication system with JWT tokens and password hashing.',
                    valueStatement: 'Users will be able to securely access their personal data and maintain privacy.',
                    riceScore: { reach: 90, impact: 85, confidence: 4, effort: 70 },
                    column: 'now',
                    status: 'active',
                    inProgress: true,
                    thumbsUp: 12,
                    emojiReactions: [
                        { emoji: '🔐', count: 5 },
                        { emoji: '👍', count: 3 }
                    ],
                    createdAt: new Date(Date.now() - 86400000).toISOString() // 1 day ago
                },
                {
                    id: 'idea-2',
                    oneLiner: 'Add dark mode support',
                    description: 'Implement a toggle for dark mode across all application pages.',
                    valueStatement: 'Users can choose their preferred visual theme for better user experience.',
                    riceScore: { reach: 60, impact: 40, confidence: 2, effort: 30 },
                    column: 'next',
                    status: 'active',
                    inProgress: false,
                    thumbsUp: 8,
                    emojiReactions: [
                        { emoji: '🌙', count: 4 },
                        { emoji: '✨', count: 2 }
                    ],
                    createdAt: new Date(Date.now() - 172800000).toISOString() // 2 days ago
                },
                {
                    id: 'idea-3',
                    oneLiner: 'Optimize database queries',
                    description: 'Review and optimize slow database queries to improve application performance.',
                    valueStatement: 'Faster load times will improve user satisfaction and reduce server costs.',
                    riceScore: { reach: 100, impact: 70, confidence: 8, effort: 80 },
                    column: 'later',
                    status: 'active',
                    inProgress: false,
                    thumbsUp: 3,
                    emojiReactions: [
                        { emoji: '⚡', count: 2 }
                    ],
                    createdAt: new Date(Date.now() - 259200000).toISOString() // 3 days ago
                }
            ];

            // Render sample ideas
            const ideasList = document.getElementById('test-ideas-list');
            ideasList.innerHTML = sampleIdeas.map(idea => 
                window.ideaManager.createIdeaCard(idea, true)
            ).join('');

            // Test buttons
            document.getElementById('test-create-btn').addEventListener('click', () => {
                window.ideaManager.openCreateModal();
            });

            document.getElementById('test-edit-btn').addEventListener('click', () => {
                window.ideaManager.editIdea('idea-1');
            });

            document.getElementById('test-delete-btn').addEventListener('click', () => {
                window.ideaManager.confirmDeleteIdea('idea-1', 'Implement user authentication system');
            });
        });
    </script>
</body>
</html>